import{a as tt}from"./chunk-OSRJP2FH.js";import{a as Z}from"./chunk-DXK57YMR.js";import{a as m}from"./chunk-KBMBIZXK.js";import{Aa as X,O as F,Q as H,Sa as Y,d as B,ea as $,h as y,ha as O,ka as U,la as G,ma as V,na as z,oa as K,pa as N,qa as P,ra as L,sa as q,ta as J,ua as Q,v as A,va as W}from"./chunk-UKH5J6BE.js";import{d as R}from"./chunk-6PNJV7BV.js";import{$ as S,$a as o,Eb as h,Mb as a,Nb as c,Ob as k,Pb as _,Qb as v,Sb as T,Vb as x,Xb as j,ab as C,ea as g,hc as s,ic as l,jc as D,lc as E,oa as I,pa as M,qb as w,tc as u,uc as f,wb as d}from"./chunk-LDMTKLXK.js";var it=(()=>{class t{constructor(e){this.http=e,this.baseUrl=m.protocol+"//"+m.host+"/"+m.root}getContacts(e){return this.http.get(`${this.baseUrl+"/getContacts"}?accountId=${e}`)}static{this.\u0275fac=function(i){return new(i||t)(g(y))}}static{this.\u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var nt=(()=>{class t{constructor(e){this.http=e,this.baseUrl=m.protocol+"//"+m.host+"/"+m.root}deleteContact(e){return this.http.post(this.baseUrl+"/deleteContact",{id:e.toString()})}static{this.\u0275fac=function(i){return new(i||t)(g(y))}}static{this.\u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function ct(t,r){if(t&1&&(a(0,"mat-option",14),s(1),c()),t&2){let e=r.$implicit;h("value",e.id),o(),E(" ",e.firstname," ",e.lastname," - ",e.contact_type," ")}}function st(t,r){t&1&&k(0,"th",15)}function lt(t,r){if(t&1){let e=T();a(0,"td",16)(1,"button",17),x("click",function(n){let p=I(e).$implicit;return j().onDelete(p.id),M(n.stopPropagation())}),a(2,"mat-icon"),s(3,"clear"),c()()()}}function mt(t,r){t&1&&(a(0,"th",15),s(1),u(2,"translate"),c()),t&2&&(o(),l(f(2,1,"contact_type")))}function pt(t,r){if(t&1&&(a(0,"td",16),s(1),c()),t&2){let e=r.$implicit;o(),l(e.type)}}function dt(t,r){t&1&&(a(0,"th",15),s(1),u(2,"translate"),c()),t&2&&(o(),l(f(2,1,"contact")))}function ut(t,r){if(t&1&&(a(0,"td",16),s(1),c()),t&2){let e=r.$implicit;o(),l(e.contact)}}function ft(t,r){t&1&&(a(0,"th",15),s(1),u(2,"translate"),c()),t&2&&(o(),D(" ",f(2,1,"primary_contact")," "))}function Ct(t,r){if(t&1&&(a(0,"td",16),s(1),c()),t&2){let e=r.$implicit;o(),D(" ",e.primary_contact," ")}}function ht(t,r){t&1&&k(0,"tr",18)}function _t(t,r){t&1&&k(0,"tr",19)}var Et=(()=>{class t{constructor(e,i,n,p,b){this.accountService=e,this.getContactService=i,this.router=n,this.snackBar=p,this.deleteContactService=b,this.accounts=[],this.contacts=[],this.displayedColumns=["delete","type","contact","primary_contact"],this.subscriptions=[]}ngAfterViewInit(){let e=this.accountService.getAccounts().subscribe(i=>{i.success?this.accounts=i.items:console.error("Greska prilikom dohvatanja naloga")},i=>{console.error("Desila se greska prilikom dohvatanja naloga:",i)});this.subscriptions.push(e)}onAccountClicked(e){let i=this.getContactService.getContacts(e).subscribe(n=>{n.success?this.contacts=n.items:console.error("Greska prilikom dohvatanja kontakta")},n=>{console.error("Desila se greska prilikom dohvatanja kontakta:",n)});this.subscriptions.push(i)}navigateToAddContact(){let e=this.contacts[0]?.account_id;if(!e){console.log("Nalog nije izabran!");return}let i=this.router.createUrlTree(["/add-contact",e]).toString();this.router.navigate([i])}onDelete(e){this.snackBar.open("Are you sure?","OK",{duration:5e3,panelClass:["custom-snackbar"]}).onAction().subscribe(()=>{console.log("ID = ",e);let n=this.deleteContactService.deleteContact(e).subscribe(()=>{console.log(`Kontakt sa ID-jem ${e} je obrisan.`)},p=>{console.error("Gre\u0161ka prilikom brisanja kontakta:",p)});this.subscriptions.push(n)})}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}static{this.\u0275fac=function(i){return new(i||t)(C(Z),C(it),C(X),C(tt),C(nt))}}static{this.\u0275cmp=w({type:t,selectors:[["app-contacts"]],decls:28,vars:13,consts:[[1,"contacts-page"],["appearance","fill"],[3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","delete"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","contact"],["matColumnDef","primary_contact"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-button","",3,"click"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,n){i&1&&(a(0,"div",0)(1,"h1"),s(2),u(3,"translate"),c(),a(4,"mat-form-field",1)(5,"mat-label"),s(6),u(7,"translate"),c(),a(8,"mat-select",2),x("selectionChange",function(b){return n.onAccountClicked(b.value)}),d(9,ct,2,4,"mat-option",3),c()(),a(10,"table",4),_(11,5),d(12,st,1,0,"th",6)(13,lt,4,0,"td",7),v(),_(14,8),d(15,mt,3,3,"th",6)(16,pt,2,1,"td",7),v(),_(17,9),d(18,dt,3,3,"th",6)(19,ut,2,1,"td",7),v(),_(20,10),d(21,ft,3,3,"th",6)(22,Ct,2,1,"td",7),v(),d(23,ht,1,0,"tr",11)(24,_t,1,0,"tr",12),c(),a(25,"button",13),x("click",function(){return n.navigateToAddContact()}),s(26),u(27,"translate"),c()()),i&2&&(o(2),l(f(3,7,"contacts")),o(4),l(f(7,9,"choose_account")),o(3),h("ngForOf",n.accounts),o(),h("dataSource",n.contacts),o(13),h("matHeaderRowDef",n.displayedColumns),o(),h("matRowDefColumns",n.displayedColumns),o(2),l(f(27,11,"add_contact")))},dependencies:[Y,B,H,F,U,G,$,A,V,N,K,P,z,L,O,q,Q,J,W,R],encapsulation:2})}}return t})();export{Et as ContactsComponent};
